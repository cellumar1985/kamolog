<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚«ãƒ¢è¨˜éŒ²å¸³</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>ğŸ¦† ã‚«ãƒ¼ãƒ¢è¨˜éŒ²å¸³</h1>

<script>
let db;

function initDB() {
  const request = indexedDB.open("kamologDB", 1);

  request.onupgradeneeded = function (event) {
    db = event.target.result;
    if (!db.objectStoreNames.contains("records")) {
      db.createObjectStore("records", { keyPath: "id" });
    }
  };

  request.onsuccess = function (event) {
    db = event.target.result;
    console.log("DB ready");
    loadRecords();
  };

  request.onerror = function () {
    alert("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ");
  };
}

initDB();


function saveRecord(record) {
  const tx = db.transaction("records", "readwrite");
  const store = tx.objectStore("records");
  store.put(record);

  tx.oncomplete = () => {
    console.log("ä¿å­˜å®Œäº†");
  };
}


function loadRecords() {
  const tx = db.transaction("records", "readonly");
  const store = tx.objectStore("records");
  const request = store.getAll();

  request.onsuccess = () => {
    const records = request.result || [];
    console.log("èª­ã¿è¾¼ã¿:", records);
    renderList(records);
  };
}


function renderList(records) {
  const list = document.getElementById("list");
  list.innerHTML = "";

  records.forEach(r => {
    const div = document.createElement("div");
    div.innerHTML = `
      <b>${r.kamo}</b> / ${r.place}<br>
      <img src="${r.photo}" width="120"><hr>
    `;
    list.appendChild(div);
  });
}


const record = {
  id: Date.now(),
  kamo: "ã‚«ãƒ«ã‚¬ãƒ¢",
  place: "ã‚ã¥ã¾é‹å‹•å…¬åœ’",
  date: "2026-01-24",
  memo: "ã¾ã„ã•ã‚“ã¨ä¸€ç·’",
  photo: imageBase64
};



</script>



<form id="recordForm">
  <div>
    <label>æ—¥ä»˜ï¼š</label><br>
    <input type="date" id="date">
  </div>

  <div>
    <label>å ´æ‰€ï¼š</label><br>
    <input type="text" id="place">
  </div>

  <div>
    <label>ã‚«ãƒ¼ãƒ¢ï¼š</label><br>
    <input type="text" id="kamo">
  </div>

  <div>
    <label>ãƒ¡ãƒ¢ï¼š</label><br>
    <textarea id="memo"></textarea>
  </div>

  <div>
    <label>å†™çœŸï¼š</label><br>
    <input type="file" id="photoInput" accept="image/*">
  </div>

  <img id="photoPreview" style="max-width: 100%; margin-top: 10px; display: none;">

  <button type="submit">ä¿å­˜</button>
</form>

